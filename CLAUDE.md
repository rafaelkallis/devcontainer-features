# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Dev Container Features monorepo containing custom features for development environments. Currently includes:

- **claude-code-mounts**: Mounts host Claude CLI configuration (`~/.claude/` and `~/.claude.json`) into dev containers via bind mounts and symlinks.

## Commands

```bash
# Test a specific feature (autogenerated tests)
devcontainer features test --skip-scenarios -f <feature-name> -i <image-name>

# Test a specific feature (scenarios)
devcontainer features test --skip-autogenerated -f <feature-name>
```

## Architecture

### Directory Structure
- `src/<feature-name>/` - Feature source code
  - `devcontainer-feature.json` - Feature manifest (metadata, options, dependencies)
  - `install.sh` - Installation script (runs as root)
- `test/<feature-name>/` - Feature test suites
  - `test.sh` - Default test (runs with default options)
  - `scenarios.json` - Test configurations for different option combinations
  - `<scenario-name>.sh` - Scenario-specific test script (runs with scenario options)

### Key Patterns
- **Option-to-Environment Variable Mapping**: Feature options in the manifest become uppercase environment variables in install.sh (e.g., `greeting` option becomes `$GREETING`)
- **Test Library**: Tests use `dev-container-features-test-lib` with `check` and `reportResults` commands
- **Feature Dependencies**: Use `installsAfter` in manifest to control installation order
